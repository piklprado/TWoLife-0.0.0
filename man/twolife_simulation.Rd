% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{twolife_simulation}
\alias{twolife_simulation}
\title{Run TWoLife Individual-Based Simulation}
\usage{
twolife_simulation(
  landscape_params = list(),
  individual_params = list(),
  genetic_params = list(),
  simulation_params = list(),
  ...,
  output_file = NULL
)
}
\arguments{
\item{landscape_params}{List containing landscape parameters:
\describe{
  \item{\code{habitat}}{Square matrix of habitat quality values (required)}
  \item{\code{cell_size}}{Size of each cell in world units (default: 1.0)}
  \item{\code{boundary_condition}}{Edge behavior: 0=absorbing, 1=periodic, 2=reflective (default: 1)}
  \item{\code{density_type}}{Density dependence: 0=global, 1=local (default: 1)}
  \item{\code{matrix_mortality_multiplier}}{Death rate multiplier in matrix habitat (default: 2.0)}
  \item{\code{matrix_dispersal_multiplier}}{Movement rate multiplier in matrix habitat (default: 0.5)}
}}

\item{individual_params}{List containing individual parameters:
\describe{
  \item{\code{initial_population_size}}{Starting number of individuals (default: 200)}
  \item{\code{neighbor_radius}}{Radius for density interactions (default: 2.0)}
  \item{\code{vision_angle}}{Angular range sampled during random walk in radians (default: pi)}
  \item{\code{step_length}}{Maximum distance moved per dispersal event (default: 1.0)}
  \item{\code{base_dispersal_rate}}{Base rate of movement events (default: 0.1)}
  \item{\code{base_birth_rate}}{Base rate of reproduction (default: 0.3)}
  \item{\code{base_mortality_rate}}{Base rate of death (default: 0.2)}
  \item{\code{birth_density_slope}}{Density effect on birth rate (default: 0.02)}
  \item{\code{mortality_density_slope}}{Density effect on death rate (default: 0.02)}
}}

\item{genetic_params}{List containing genetic parameters:
\describe{
  \item{\code{genotype_means}}{Optimal habitat values for each individual (default: all 1.0)}
  \item{\code{genotype_sds}}{Niche width (habitat tolerance) for each individual (default: all 0.0)}
  \item{\code{mutation_rates}}{Mutation rate per generation for each individual (default: all 0.0)}
  \item{\code{plasticities}}{Phenotypic flexibility for each individual (default: all 0.0)}
  \item{\code{sampling_points}}{Number of locations sampled for habitat selection (default: all 0 = random walk)}
}}

\item{simulation_params}{List containing simulation control parameters:
\describe{
  \item{\code{max_events}}{Maximum number of demographic events (auto-calculated if NULL)}
  \item{\code{neutral_mode}}{All individuals act with fitness of the average initial population (default: FALSE)}
}}

\item{...}{Additional named arguments (deprecated - use parameter lists instead)}

\item{output_file}{Optional file path for detailed event output (advanced usage)}
}
\value{
A list of class 'twolife_result' containing:
  \describe{
    \item{\code{summary}}{List with final_population_size, total_events, duration, status}
    \item{\code{survivors}}{Data frame with id, x, y, genotype for surviving individuals}
    \item{\code{spatial}}{List with world_size and num_patches}
    \item{\code{events}}{List with complete event history (times, types, coordinates, genotypes)}
    \item{\code{parameters}}{All parameters used in the simulation}
  }
}
\description{
Execute a spatially-explicit individual-based population simulation where organisms
move, reproduce, and die across heterogeneous landscapes. Supports genetic evolution,
habitat selection behavior, and density-dependent demography.
}
\details{
TWoLife simulates individual-based population dynamics where each organism has:
\itemize{
  \item Spatial location with movement behavior
  \item Genetic traits determining habitat preferences  
  \item Demographic rates affected by local density
  \item Optional behavioral habitat selection
}

The simulation proceeds as a continuous-time Markov process where individuals
experience birth, death, or dispersal events with rates determined by their
genetic traits, local environment, and nearby population density.
}
\section{Parameter Guidelines}{

\itemize{
  \item Ensure \code{base_birth_rate > base_mortality_rate} for population viability
  \item Use \code{step_length <= neighbor_radius} for realistic spatial interactions  
  \item Set \code{sampling_points > 0} to enable habitat selection behavior
  \item Match genetic parameter vector lengths to \code{initial_population_size}
}
}

\examples{
# Basic simulation with default parameters
habitat <- create_fractal_landscape(8, fractality = 0.6, habitat_proportion = 0.4)
result <- twolife_simulation(
  landscape_params = list(habitat = habitat),
  individual_params = list(initial_population_size = 10),
  simulation_params = list(max_events = 50)
)
print(result)

\donttest{
# Advanced simulation with genetic evolution
result_genetic <- twolife_simulation(
  landscape_params = list(
    habitat = habitat,
    boundary_condition = 1,  # Periodic boundaries
    density_type = 1         # Local density dependence
  ),
  individual_params = list(
    initial_population_size = 20,
    base_birth_rate = 0.35,
    base_mortality_rate = 0.25
  ),
  genetic_params = list(
    genotype_means = runif(20, 0.3, 0.7),    # Diverse starting genotypes
    genotype_sds = rep(0.15, 20),            # Moderate specialists
    mutation_rates = rep(0.03, 20),          # Moderate evolution
    plasticities = rep(0.02, 20),            # Low plasticity
    sampling_points = rep(5, 20)             # Habitat selection
  ),
  simulation_params = list(max_events = 200)
)

# Visualize results
plot_simulation_on_landscape(result_genetic)
}

}
\seealso{
\code{\link{create_fractal_landscape}} for landscape generation,
\code{\link{plot_simulation_on_landscape}} for result visualization,
\code{\link{compute_population_size}} for trajectory analysis
}
